{"ast":null,"code":"import { FormControl, FormGroup, Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../main-service.service\";\nimport * as i2 from \"@angular/material/snack-bar\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"@angular/material/autocomplete\";\nimport * as i6 from \"@angular/material/core\";\nimport * as i7 from \"@angular/material/slide-toggle\";\n\nfunction PartyCollectionComponent_mat_option_19_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"mat-option\", 19);\n    i0.ɵɵlistener(\"onSelectionChange\", function PartyCollectionComponent_mat_option_19_Template_mat_option_onSelectionChange_0_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const option_r4 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.onPartySelect($event, option_r4._id));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const option_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", option_r4.name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", option_r4.name, \" \");\n  }\n}\n\nconst _c0 = function () {\n  return {\n    standalone: true\n  };\n};\n\nexport let PartyCollectionComponent = /*#__PURE__*/(() => {\n  class PartyCollectionComponent {\n    constructor(mainService, _snackBar) {\n      this.mainService = mainService;\n      this._snackBar = _snackBar;\n      this.date = new Date();\n      this.isPrinting = false;\n      this.dateToShow = Date().toString().substring(0, 15);\n      this.sendSMS = true;\n    }\n\n    ngOnInit() {\n      this.form = new FormGroup({\n        party_name: new FormControl(null, Validators.required),\n        amount: new FormControl(null, Validators.required)\n      });\n    }\n\n    partyName(val) {\n      clearTimeout(this.timer);\n      this.options = [];\n      this.timer = setTimeout(() => {\n        console.log(val);\n        this.mainService.autoCompleteName(val, 'types=0&types=2&types=3').then(arr => {\n          console.log(arr);\n          this.options = arr;\n        });\n      }, 1000);\n    } //\n\n\n    sendSMSStatus() {\n      this.sendSMS = !this.sendSMS;\n    }\n\n    onPartySelect(name, id) {\n      console.log(name.source.value);\n      this.selectedPartyId = id;\n      console.log(id);\n      this.mainService.findParty(name.source.value).then(data => {\n        // console.log(data.commission);\n        this.remaining = data.current;\n      });\n    }\n\n    onSave(amount) {\n      this.mainService.addVasuli(this.selectedPartyId, amount, this.date).then(data => {\n        this.remaining = this.remaining - amount;\n\n        this._snackBar.open('Transaction Saved', 'Close');\n      });\n\n      if (this.sendSMS) {\n        this.mainService.sendSMS().then(data => {\n          console.log('Msg sent', data);\n        });\n      }\n    }\n\n    resetForm() {\n      // this.purchaseForm.markAsPristine();\n      this.form.reset();\n    }\n\n    printIt() {\n      this.mainService.purchasePrint.next('partyCollection');\n      setTimeout(() => {\n        window.print();\n      }, 0);\n    }\n\n  }\n\n  PartyCollectionComponent.ɵfac = function PartyCollectionComponent_Factory(t) {\n    return new (t || PartyCollectionComponent)(i0.ɵɵdirectiveInject(i1.MainServiceService), i0.ɵɵdirectiveInject(i2.MatSnackBar));\n  };\n\n  PartyCollectionComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: PartyCollectionComponent,\n    selectors: [[\"app-party-collection\"]],\n    decls: 44,\n    vars: 8,\n    consts: [[1, \"heading\"], [1, \"firstDiv\"], [1, \"mainForm\", 3, \"formGroup\", \"ngSubmit\"], [1, \"row\"], [1, \"col\"], [1, \"form-label\"], [1, \"input-group\", \"mb-3\"], [\"type\", \"text\", \"placeholder\", \"Party Name\", \"formControlName\", \"party_name\", 1, \"form-control\", 3, \"matAutocomplete\", \"input\"], [\"username\", \"\"], [\"auto\", \"matAutocomplete\"], [3, \"value\", \"onSelectionChange\", 4, \"ngFor\", \"ngForOf\"], [1, \"input-group-text\"], [\"type\", \"text\", \"placeholder\", \"Amount\", \"formControlName\", \"amount\", 1, \"form-control\"], [\"amount\", \"\"], [\"type\", \"button\", 1, \"btn\", \"btn-primary\", 3, \"click\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"click\"], [1, \"row\", 2, \"margin-top\", \"30px\"], [1, \"col\", 2, \"margin-top\", \"6px\"], [3, \"ngModel\", \"ngModelOptions\", \"ngModelChange\", \"click\"], [3, \"value\", \"onSelectionChange\"]],\n    template: function PartyCollectionComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r7 = i0.ɵɵgetCurrentView();\n\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵtext(1, \"VYAPARI VASULI\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(2, \"hr\");\n        i0.ɵɵelementStart(3, \"div\", 1)(4, \"form\", 2);\n        i0.ɵɵlistener(\"ngSubmit\", function PartyCollectionComponent_Template_form_ngSubmit_4_listener() {\n          return ctx.resetForm();\n        });\n        i0.ɵɵelementStart(5, \"div\", 3)(6, \"div\", 4)(7, \"label\", 5);\n        i0.ɵɵtext(8, \"BILL NUMBER\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(9, \"div\", 4)(10, \"label\", 5);\n        i0.ɵɵtext(11);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(12, \"label\", 5);\n        i0.ɵɵtext(13, \"This Reciept is to confirm a collection from\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"div\", 6)(15, \"input\", 7, 8);\n        i0.ɵɵlistener(\"input\", function PartyCollectionComponent_Template_input_input_15_listener() {\n          i0.ɵɵrestoreView(_r7);\n\n          const _r0 = i0.ɵɵreference(16);\n\n          return i0.ɵɵresetView(ctx.partyName(_r0.value));\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(17, \"mat-autocomplete\", null, 9);\n        i0.ɵɵtemplate(19, PartyCollectionComponent_mat_option_19_Template, 2, 2, \"mat-option\", 10);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"span\", 11);\n        i0.ɵɵtext(21, \"OF Rs\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(22, \"input\", 12, 13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(24, \"hr\");\n        i0.ɵɵelementStart(25, \"div\", 3)(26, \"div\", 4)(27, \"button\", 14);\n        i0.ɵɵlistener(\"click\", function PartyCollectionComponent_Template_button_click_27_listener() {\n          i0.ɵɵrestoreView(_r7);\n\n          const _r3 = i0.ɵɵreference(23);\n\n          return i0.ɵɵresetView(ctx.onSave(_r3.value));\n        });\n        i0.ɵɵtext(28, \" Save \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(29, \"div\", 4)(30, \"button\", 15);\n        i0.ɵɵlistener(\"click\", function PartyCollectionComponent_Template_button_click_30_listener() {\n          return ctx.resetForm();\n        });\n        i0.ɵɵtext(31, \" New \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(32, \"div\", 4)(33, \"button\", 14);\n        i0.ɵɵlistener(\"click\", function PartyCollectionComponent_Template_button_click_33_listener() {\n          return ctx.printIt();\n        });\n        i0.ɵɵtext(34, \" Print \");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(35, \"div\", 16)(36, \"div\", 4)(37, \"h3\");\n        i0.ɵɵtext(38);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(39, \"h3\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(40, \"div\", 17)(41, \"mat-slide-toggle\", 18);\n        i0.ɵɵlistener(\"ngModelChange\", function PartyCollectionComponent_Template_mat_slide_toggle_ngModelChange_41_listener($event) {\n          return ctx.sendSMS = $event;\n        })(\"click\", function PartyCollectionComponent_Template_mat_slide_toggle_click_41_listener() {\n          return ctx.sendSMSStatus();\n        });\n        i0.ɵɵelementStart(42, \"h5\");\n        i0.ɵɵtext(43, \"Send SMS\");\n        i0.ɵɵelementEnd()()()()()();\n      }\n\n      if (rf & 2) {\n        const _r1 = i0.ɵɵreference(18);\n\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"formGroup\", ctx.form);\n        i0.ɵɵadvance(7);\n        i0.ɵɵtextInterpolate1(\"DATE - \", ctx.dateToShow, \"\");\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"matAutocomplete\", _r1);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngForOf\", ctx.options);\n        i0.ɵɵadvance(19);\n        i0.ɵɵtextInterpolate1(\"Remaining \", ctx.remaining, \"\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.sendSMS)(\"ngModelOptions\", i0.ɵɵpureFunction0(7, _c0));\n      }\n    },\n    dependencies: [i3.NgForOf, i4.ɵNgNoValidate, i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.FormGroupDirective, i4.FormControlName, i5.MatAutocomplete, i5.MatAutocompleteTrigger, i6.MatOption, i7.MatSlideToggle, i4.NgModel]\n  });\n  return PartyCollectionComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}